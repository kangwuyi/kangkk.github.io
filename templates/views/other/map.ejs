<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <title>KK.</title>
  <link href="favicon.ico" type="image/x-icon" rel="shortcut icon">
  <link crossorigin="anonymous" integrity="sha384-9Z9AuAj0Xi0z7WFOSgjjow8EnNY9wPNp925TVLlAyWhvZPsf5Ks23Ex0mxIrWJzJ"
    href="https://s2.ssl.qhres2.com/baomitu/normalize/8.0.1/normalize.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <%- include('../assets') %>
  <style type="text/css">
    .subunit.CHN { fill: #e6e6e6; }
    .subunit.HKG { fill: #cdcdcd; }
    .subunit.TWN { fill: #dbdbdb; }
    .subunit.MAC { fill: #bfbfbf; }
    .subunit-boundary {
      fill: none;
      stroke: #777;
      stroke-dasharray: 2, 2;
      stroke-linejoin: round;
    }
    .place-boundary {
      fill: none;
      stroke: #777;
      stroke-dasharray: 2, 2;
      stroke-linejoin: round;
    }
    .subunit-label {
      fill: #777;
      fill-opacity: .5;
      font-size: 20px;
      font-weight: 300;
      text-anchor: middle;
    }
    .place,
    .place-label {
      fill: #444;
    }
    text {
      font-size: 10px;
      pointer-events: none;
    }
    .wrap {
      display: flex;
    }
    .canvas {
      width: 850px;
      height: 650px;
    }
    .content {
      margin-top: 100px;
      width: 400px;
    }
    .content p {
      line-height: 1.5;
    }
    .site {
      margin: 50px 0;
    }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="canvas"></div>
      <div class="content">
        <%- include('../home/header') %>
        <div class="site">
          <p>å¼€å§‹æƒ³ç€è®°å½•ä¸‹è¶³è¿¹ ğŸ‘£ <sub>2023-05-12 14:01</sub> ã€‚ä¹Ÿä¸çŸ¥é“ä¼šæœ‰ä»€ä¹ˆç”¨å¤„ï¼Œå¤§æ¦‚å°±æ˜¯ä¸€ç§ç±»ä¼¼â€œå½“æˆ‘è€äº†ä¹‹åï¼Œæœ‰ä¸€å¤©è¡€è¡€æ¥æ½®æƒ³çœ‹çœ‹è‡ªå·±éƒ½å»è¿‡å“ªé‡Œï¼Œåˆé¢„é˜²è€å¹´è®°å¿†ä¸å¥½ï¼Œæå‰ç¬”è®°â€çš„æ„æ€å§ã€‚</p>
          <p>ä¹Ÿå¸Œæœ›é€šè¿‡è¿™å¼ åœ°å›¾æé†’è‡ªå·±ï¼Œâ€œä¸–ç•Œè¿™ä¹ˆå¤§â€ä¸å»å¤šèµ°èµ°å¤šçœ‹çœ‹å¤ªå¯æƒœäº†ã€‚ä½†å®é™…ä¸Šå…¶å®å¾ˆéš¾æœ‰æœºä¼šå»å¾ˆå¤šåœ°æ–¹å§ï¼Œç½‘ç»œè¯æ±‡æ€ä¹ˆè¯´çš„æ¥ç€ï¼Œç†æƒ³å¾ˆå¥½ä½†ç°å®ä¸æ˜¯å¤ªå¤Ÿä¸°æ»¡ï¼Œæƒ³è¦è¿œæ–¹å’Œè¯—ï¼Œæ€»æ˜¯è¦æ‹¥æœ‰å‰ç½®æ¡ä»¶çš„ã€‚</p>
        </div>
        <%- include('../home/footer') %>
      </div>
    </div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://lib.baomitu.com/topojson/3.0.2/topojson.min.js"></script>
    <script type="text/javascript">
      const width = 850;
      const height = 650;
  
      const projection = d3.geoAlbers()
        .center([0, 36])
        .rotate([-105, 0])
        .parallels([27, 45])
        .scale(850)
        .translate([width / 2, height / 2]);
  
      const path = d3.geoPath()
        .projection(projection)
        .pointRadius(2);
  
      const svg = d3.select(".canvas").append("svg")
        .attr("width", width)
        .attr("height", height);
  
      const GEONAMESIDs = [];
      const NE_IDs = [];
      // å“ˆå°”æ»¨/åŒ—äº¬/ç¦å·/å¤©æ´¥/é’å²›/æ­å·/æ²ˆé˜³
      const WOF_IDs = [102027921, 102027745, 102027611, 102027107, 102027571, 102027241, 102027875];
  
          // geo.path geoPath
      d3.json("../map/cn.json").then(function(data, error) {
        const subunits = topojson.feature(data, data.objects.subunits);
        const places = topojson.feature(data, data.objects.places);
        const placePoints = {...places, features: places.features.filter(_ => (
          GEONAMESIDs.includes(_.properties.GEONAMESID) || 
          NE_IDs.includes(_.properties.NE_ID) || 
          WOF_IDs.includes(_.properties.WOF_ID)
        ))}
  
        // æ ¹æ® geojson æç»˜åœ°å›¾è½®å»“
        svg.append("path")
          .datum(subunits)
          .attr("d", path);
  
        // ä¾æ® ADM0_A3 åˆ’åˆ†åŒºåŸŸå¹¶ä¸Šè‰²
        svg.selectAll(".subunit")
          .data(subunits.features)
          .enter()
          .append("path")
          .attr("class", d => "subunit " + d.properties.ADM0_A3)
          .attr("d", path);
  
        // å¯¹åŒºåŸŸè¿›è¡Œè™šçº¿æè¾¹
        // topojson.mesh ä»æ‹“æ‰‘è®¡ç®—è¾¹ç•Œ
        svg.append("path")
          .datum(topojson.mesh(data, data.objects.subunits, (a, b) => a.properties.ADM0_A3 !== "MAC"))
          .attr("d", path)
          .attr("class", (_d, i) => "subunit-boundary subunit-boundary" + i);
        
        // æ·»åŠ åŒºåŸŸæ ‡é¢˜
        // svg.selectAll(".subunit-label")
        //   .data(subunits.features)
        //   .enter()
        //   .append("text")
        //   .attr("class", d => "subunit-label subunit-label" + d.properties.NAME_ZH)
        //   .attr("transform", d => "translate(" + path.centroid(d) + ")")
        //   .attr("dy", ".35em")
        //   .text(d => d.properties.NAME_ZH);
  
        // è®¡ç®—åœ°ç‚¹
        svg.append("path")
          .datum(placePoints)
          .attr("d", path)
          .attr("class", "place");
  
        // è®¡ç®—åœ°æ–¹æ–‡å­—
        svg.selectAll(".place-label")
          .data(placePoints.features)
          .enter()
          .append("text")
          .attr("class", "place-label")
          .attr("transform", d => "translate(" + projection(d.geometry.coordinates) + ")")
          .attr("x", d => d.geometry.coordinates[0] > -1 ? 6 : -6)
          .attr("dy", ".35em")
          .text(d => d.properties.NAME_ZH);
      });
    </script>
  </body>
</html>

 
